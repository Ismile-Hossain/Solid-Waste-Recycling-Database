1.
/
SELECT AGENT_NAME AS "AGENT NAME",AGENT_SHOP_NAME AS "SHOP NAME",AGENT_AREA,LD.DEALER_NAME
FROM 
TRANSACTION_SUPPORT T JOIN AGENT_TRANSACTION AT ON
T.TRANSACTION_ID=AT.TRANSACTION_ID AND T.TRANSACTION_DATE=AT.TRANSACTION_DATE
JOIN AREA_AGENT AA ON
AT.AGENT_ID=AA.AGENT_ID 
JOIN COLLECTOR C ON
AA.AGENT_ID=C.AGENT_ID
JOIN LOCAL_DEALER LD ON
C.DEALER_DEALERSHIP_NO=LD.DEALER_DEALERSHIP_NO

WHERE TO_DATE(T.TRANSACTION_DATE)
IN
(
SELECT TO_DATE(TRANSACTION_DATE) 
FROM TRANSACTION_SUPPORT
WHERE TRANSACTION_ID='TRANSC_00000003'

);


2.
//AGENT MAX TRANS SPECIFIC TIME A
SELECT AGENT_NAME AS "AGENT NAME",AGENT_SHOP_NAME AS "SHOP NAME",AGENT_AREA,T.AMOUNT
FROM 
TRANSACTION_SUPPORT T JOIN AGENT_TRANSACTION AT ON
T.TRANSACTION_ID=AT.TRANSACTION_ID AND T.TRANSACTION_DATE=AT.TRANSACTION_DATE
JOIN AREA_AGENT AA ON
AT.AGENT_ID=AA.AGENT_ID 
WHERE T.AMOUNT 
IN
(
SELECT MAX(AMOUNT) 
FROM TRANSACTION_SUPPORT
WHERE TRANSACTION_DATE BETWEEN TO_DATE('01-01-2019','DD-MM-YYYY')  
AND TO_DATE('20-06-2019','DD-MM-YYYY')
)
;

3.
/*SPECIFIC DUSTBIN*/
SELECT DUSTBIN_NUMBER,COLLECTED_WEIGHT_PER_DUSTBIN "COLLECTED AMOUNT", AGENT_NAME,AGENT_AREA
FROM 
TRANSACTION_SUPPORT T JOIN AGENT_TRANSACTION ATT ON
T.TRANSACTION_ID=ATT.TRANSACTION_ID AND T.TRANSACTION_DATE=ATT.TRANSACTION_DATE
JOIN AREA_AGENT AA ON
ATT.AGENT_ID=AA.AGENT_ID 
JOIN AGGREGATOR AG ON 
AA.AGENT_ID=AG.AGENT_ID
JOIN LOCAL_WASTE_COLLECTOR LWC ON
AG.COLLECTOR_ID=LWC.COLLECTOR_ID
JOIN SCAVENGERS SC ON
LWC.COLLECTOR_ID=SC.COLLECTOR_ID
WHERE T.AMOUNT 
IN
(

(
SELECT MAX(AMOUNT) 
FROM TRANSACTION_SUPPORT
WHERE TRANSACTION_DATE BETWEEN TO_DATE('01-01-2019','DD-MM-YYYY')  
AND TO_DATE('01-06-2019','DD-MM-YYYY')
)
)
AND 
 
DUSTBIN_NUMBER=10 ;



4.


SELECT LWC.COLLECTOR_NAME,DUSTBIN_NUMBER,COLLECTED_WEIGHT_PER_DUSTBIN "COLLECTED AMOUNT", AGENT_NAME,AGENT_AREA,(ROUND(T.AMOUNT*T.PER_UNIT_PRICE,3))"AGENT INCOME"
FROM 
TRANSACTION_SUPPORT T JOIN AGENT_TRANSACTION ATT ON
T.TRANSACTION_ID=ATT.TRANSACTION_ID AND T.TRANSACTION_DATE=ATT.TRANSACTION_DATE
JOIN AREA_AGENT AA ON
ATT.AGENT_ID=AA.AGENT_ID 
JOIN AGGREGATOR AG ON 
AA.AGENT_ID=AG.AGENT_ID
JOIN LOCAL_WASTE_COLLECTOR LWC ON
AG.COLLECTOR_ID=LWC.COLLECTOR_ID
JOIN SCAVENGERS SC ON
LWC.COLLECTOR_ID=SC.COLLECTOR_ID
WHERE T.AMOUNT 
IN
(

(
SELECT (AMOUNT) 
FROM TRANSACTION_SUPPORT
WHERE TRANSACTION_DATE BETWEEN TO_DATE('01-01-2019','DD-MM-YYYY')  
AND TO_DATE('01-06-2019','DD-MM-YYYY')
)

)
AND (ROUND(T.AMOUNT*T.PER_UNIT_PRICE,3)) IN
(
SELECT (ROUND(AMOUNT*PER_UNIT_PRICE,3))
FROM TRANSACTION_SUPPORT
WHERE AMOUNT BETWEEN 1000 AND 5000 
)

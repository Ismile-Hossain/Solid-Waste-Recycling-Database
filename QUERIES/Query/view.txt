1.

CREATE OR REPLACE  VIEW
LOCAL_DEALER_VIEW("DEALERSHIP NUMBER","NAME","CITY","TYPE OF WASTE","AMOUNT","DATE") 
AS
SELECT  LD.DEALER_DEALERSHIP_NO,LD.DEALER_NAME,DEALER_CITY,T.TYPES_WASTE,T.AMOUNT,T.TRANSACTION_DATE
FROM
LOCAL_DEALER LD JOIN LOCAL_DEALER_TRANSACTION DT ON
LD.DEALER_DEALERSHIP_NO=DT.DEALER_DEALERSHIP_NO
JOIN TRANSACTION_SUPPORT T ON
DT.TRANSACTION_ID=T.TRANSACTION_ID
AND
DT.TRANSACTION_DATE=T.TRANSACTION_DATE 
;

2.

CREATE OR REPLACE  VIEW
DEALER_AGENT_VIEW("DEALER NAME","AGENT NAME","CITY","AREA","TYPE OF WASTE","AMOUNT","DATE") 
AS
SELECT  LD.DEALER_NAME,AA.AGENT_NAME,DEALER_CITY,AA.AGENT_AREA,T.TYPES_WASTE,T.AMOUNT,T.TRANSACTION_DATE
FROM
TRANSACTION_SUPPORT T JOIN LOCAL_DEALER_TRANSACTION DT 
ON
DT.TRANSACTION_ID=T.TRANSACTION_ID
AND
DT.TRANSACTION_DATE=T.TRANSACTION_DATE
JOIN LOCAL_DEALER LD 
ON 
DT.DEALER_DEALERSHIP_NO=LD.DEALER_DEALERSHIP_NO
JOIN COLLECTOR C
ON 
LD.DEALER_DEALERSHIP_NO=C.DEALER_DEALERSHIP_NO
JOIN AREA_AGENT AA
ON
C.AGENT_ID=AA.AGENT_ID 
 
;


3.

CREATE OR  REPLACE VIEW 
ARGENT_VIEW("AGENT NUMBER","NAME","CITY","TYPE OF WASTE","AMOUNT","DATE","INCOME") 
AS
SELECT  AA.AGENT_ID,AA.AGENT_NAME,AGENT_CITY,T.TYPES_WASTE,T.AMOUNT,T.TRANSACTION_DATE,(ROUND(T.AMOUNT*T.PER_UNIT_PRICE,3))
FROM
AREA_AGENT AA JOIN AGENT_TRANSACTION AT ON
AA.AGENT_ID=AT.AGENT_ID
JOIN TRANSACTION_SUPPORT T ON
AT.TRANSACTION_ID=T.TRANSACTION_ID
AND
AT.TRANSACTION_DATE=T.TRANSACTION_DATE 
WHERE 
AMOUNT>500 
;








